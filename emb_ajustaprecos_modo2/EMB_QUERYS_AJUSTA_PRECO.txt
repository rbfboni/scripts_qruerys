QRNAME
EMBA_EP_AJUSTA_CLIEN

SELECT DISTINCT EP_CPROD.CODFAVOREC,
       EP_CPROD.SEQFAVFAT,
       FVG.NOME,
       FVE.RAZAO,
       FVE.APELIDO,
       FVE.CIDADE,
       FVE.ESTADO
  FROM EP_CPROD
 INNER JOIN FV_FAVOR FVG ON ( EP_CPROD.CODFAVOREC = FVG.CODFAVOREC )
 LEFT OUTER JOIN FV_END FVE ON ( EP_CPROD.CODFAVOREC = FVE.CODFAVOREC AND EP_CPROD.SEQFAVFAT = FVE.SEQ )

* NENHUM CAMPO CALCULADO
* NENHUM FILTRO

******************************************************************************************************************************************

QRNAME
EMBA_EP_AJUSTA_PRECO

SELECT O.CODMAT,
       O.CODTPESTOQUE,
       GM_CMAT.CODEXT,
       GM_CMAT.DESCR,
       GM_CTPES.TPESTOQUE,
       O.CODFAVOREC,
       O.SEQFAVFAT,
       FV_FAVOR.NOME CLIENTE,
       FV_END.RAZAO,
       FV_END.ESTADO,
       FV_END.CIDADE,
       FV_END.CGCCPF,
       ( SELECT EP_CCPSG.SEQINT
  FROM EP_CCPSG
 WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=18 ) SEQINT07,
       ( SELECT EP_CCPSG.VLCAMPO FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=18 ) PRECO07,
       ( SELECT EP_CCPSG.SEQINT FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=19 ) SEQINT12,
       ( SELECT EP_CCPSG.VLCAMPO FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=19 ) PRECO12,
       ( SELECT EP_CCPSG.SEQINT FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=20 ) SEQINT18,
       ( SELECT EP_CCPSG.VLCAMPO FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=20 ) PRECO18,
       ( SELECT EP_CCPSG.SEQINT FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=25 ) SEQINTDATA,
       ( SELECT EP_CCPSG.DTCAMPO FROM EP_CCPSG WHERE O.CODMAT=EP_CCPSG.CODMAT AND O.CODTPESTOQUE=EP_CCPSG.CODTPESTOQUE AND EP_CCPSG.CODCAMPO=25 ) ULTREAJUSTE,
       ( SELECT FIRST 1 EPSEMEND.ESTADO FROM FV_END EPSEMEND WHERE O.CODFAVOREC=EPSEMEND.CODFAVOREC AND O.SEQFAVFAT IS NULL AND EPSEMEND.ESTADO <>'' ) ESTADOSEMENDER
  FROM EP_CPROD O
 INNER JOIN GM_CMAT  ON ( O.CODMAT = GM_CMAT.CODMAT )
 INNER JOIN GM_CTPES ON ( O.CODMAT = GM_CTPES.CODMAT AND O.CODTPESTOQUE = GM_CTPES.CODTPESTOQUE )
  LEFT OUTER JOIN FV_FAVOR ON ( O.CODFAVOREC = FV_FAVOR.CODFAVOREC )
  LEFT OUTER JOIN FV_END   ON ( O.CODFAVOREC=FV_END.CODFAVOREC AND O.SEQFAVFAT=FV_END.SEQ )
 WHERE ( O.CODMAT <> 0 )
   AND ( O.CODTPESTOQUE = ( SELECT MAX( G.CODTPESTOQUE ) FROM GM_CTPES G WHERE O.CODMAT=G.CODMAT AND G.ATIVO='S' ) )

* NENHUM CAMPO CALCULADO
* NENHUM FILTRO